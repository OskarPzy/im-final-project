# 工业产品质量检测系统

## 项目简介

基于计算机视觉和机器学习的工业产品质量检测系统，使用电脑摄像头实时拍摄产品图像，自动检测产品缺陷，并记录检测数据进行可视化分析。

## 核心功能

1. **实时摄像头捕获** - 使用电脑自带摄像头拍摄产品图像
2. **质量检测** - 基于计算机视觉和机器学习算法检测产品缺陷
3. **数据采集** - 自动记录每次检测的结果和时间戳
4. **数据可视化** - 展示检测统计、趋势图表和检测历史

## 技术栈

- **后端**: Flask (Python Web框架)
- **计算机视觉**: OpenCV
- **机器学习**: scikit-learn
- **数据处理**: NumPy, PIL
- **数据可视化**: Matplotlib
- **数据库**: SQLite (通过Flask-SQLAlchemy)

## 安装步骤

1. 安装Python依赖：
```bash
pip install -r requirements.txt
```

2. 运行应用：
```bash
python app.py
```

3. 在浏览器中打开：`http://localhost:5000`

## 使用说明

1. 点击"开始检测"按钮启动摄像头
2. 将产品放置在摄像头前
3. 点击"拍摄并检测"按钮进行检测
4. 查看检测结果和统计数据
5. 在"检测历史"页面查看所有历史记录

## 技术实现细节

### 1. 计算机视觉特征提取
- **颜色特征**: HSV颜色空间的直方图分析
- **纹理特征**: 局部二值模式(LBP)的简化实现
- **边缘特征**: Canny边缘检测算法
- **形状特征**: 轮廓检测和分析

### 2. 缺陷检测算法
系统使用多维度特征分析来检测产品缺陷：
- 颜色异常检测（污渍、变色）
- 边缘异常检测（划痕、裂纹）
- 亮度异常检测（阴影、反光问题）
- 纹理异常检测（表面不平整）
- 轮廓异常检测（形状缺陷）

### 3. 机器学习应用
- 使用特征工程提取多维特征向量
- 基于规则和统计方法的缺陷分类
- 质量分数计算（0-100分）

### 4. 数据采集与存储
- SQLite数据库存储检测记录
- 记录时间戳、检测结果、置信度、缺陷类型等
- 支持历史数据查询和统计分析

### 5. 数据可视化
- 实时统计卡片显示
- 检测历史表格
- Chart.js图表展示（柱状图、饼图）

## 项目结构

```
IM-final-proj/
├── app.py                 # Flask主应用
├── models.py              # 数据库模型
├── detector.py            # 质量检测算法
├── camera_utils.py         # 摄像头工具函数
├── requirements.txt       # Python依赖
├── README.md              # 项目说明
├── run.bat                # Windows启动脚本
├── .gitignore             # Git忽略文件
├── templates/             # HTML模板
│   ├── index.html         # 主页
│   └── history.html       # 历史记录页
└── static/                # 静态资源
    ├── css/
    │   └── style.css      # 样式文件
    ├── js/
    │   ├── main.js        # 主页JavaScript
    │   └── history.js     # 历史页JavaScript
    └── images/            # 检测图像存储目录（自动创建）
```

## 快速开始

### Windows用户
直接双击运行 `run.bat` 文件

### 手动启动
1. 安装依赖：`pip install -r requirements.txt`
2. 运行应用：`python app.py`
3. 访问：`http://localhost:5000`

## 注意事项

1. **摄像头权限**: 首次使用时浏览器会请求摄像头权限，请允许访问
2. **浏览器兼容**: 建议使用Chrome、Edge或Firefox浏览器
3. **Python版本**: 需要Python 3.7或更高版本
4. **检测效果**: 检测效果取决于光照条件和产品特征，建议在良好光照环境下使用

## 课程设计要点

本项目完整实现了课程要求的四个技术点：
1. ✅ **Python编程和Web开发**: Flask框架构建Web应用
2. ✅ **计算机视觉编程**: OpenCV进行图像处理和特征提取
3. ✅ **工业数据采集和可视化**: SQLite存储数据，Chart.js可视化
4. ✅ **机器学习和工业ML**: 特征工程和缺陷分类算法

